From: Chow Loong Jin <hyperair@ubuntu.com>
Date: Mon, 22 Nov 2010 04:36:40 +0800
Subject: Revert "[ArtworkManager] Cache null artwork for fast lookup"

This reverts commit 768c76da611a990054ff0921f24d566de86ac749.
---
 .../Banshee.Collection.Gui/ArtworkManager.cs       |   15 ---------------
 1 file changed, 15 deletions(-)

diff --git a/src/Core/Banshee.ThickClient/Banshee.Collection.Gui/ArtworkManager.cs b/src/Core/Banshee.ThickClient/Banshee.Collection.Gui/ArtworkManager.cs
index 6e1aa47..fe5f25e 100644
--- a/src/Core/Banshee.ThickClient/Banshee.Collection.Gui/ArtworkManager.cs
+++ b/src/Core/Banshee.ThickClient/Banshee.Collection.Gui/ArtworkManager.cs
@@ -50,7 +50,6 @@ namespace Banshee.Collection.Gui
     {
         private Dictionary<int, SurfaceCache> scale_caches  = new Dictionary<int, SurfaceCache> ();
         private HashSet<int> cacheable_cover_sizes = new HashSet<int> ();
-        private HashSet<string> null_artwork_ids = new HashSet<string> ();
 
         private class SurfaceCache : LruCache<string, Cairo.ImageSurface>
         {
@@ -122,13 +121,8 @@ namespace Banshee.Collection.Gui
                 return surface;
             }
 
-            if (null_artwork_ids.Contains (id)) {
-                return null;
-            }
-
             Pixbuf pixbuf = LookupScalePixbuf (id, size);
             if (pixbuf == null || pixbuf.Handle == IntPtr.Zero) {
-                null_artwork_ids.Add (id);
                 return null;
             }
 
@@ -168,17 +162,12 @@ namespace Banshee.Collection.Gui
                 return null;
             }
 
-            if (null_artwork_ids.Contains (id)) {
-                return null;
-            }
-
             // Find the scaled, cached file
             string path = CoverArtSpec.GetPathForSize (id, size);
             if (File.Exists (new SafeUri (path))) {
                 try {
                     return new Pixbuf (path);
                 } catch {
-                    null_artwork_ids.Add (id);
                     return null;
                 }
             }
@@ -195,7 +184,6 @@ namespace Banshee.Collection.Gui
                         Pixbuf pixbuf = new Pixbuf (unconverted_path);
                         if (pixbuf.Width < 50 || pixbuf.Height < 50) {
                             Hyena.Log.DebugFormat ("Ignoring cover art {0} because less than 50x50", unconverted_path);
-                            null_artwork_ids.Add (id);
                             return null;
                         }
 
@@ -236,7 +224,6 @@ namespace Banshee.Collection.Gui
                 } catch {}
             }
 
-            null_artwork_ids.Add (id);
             return null;
         }
 
@@ -256,8 +243,6 @@ namespace Banshee.Collection.Gui
                 scale_caches[size].Remove (id);
             }
 
-            null_artwork_ids.Remove (id);
-
             if (inMemoryCacheOnly) {
                 return;
             }
-- 
